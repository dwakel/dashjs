!function(){if("function"==typeof NodeList.prototype.forEach)return!1;NodeList.prototype.forEach=Array.prototype.forEach}(),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),a=t.length;--a>=0&&t.item(a)!==this;);return a>-1});var DashboardHandlers={handleClickEvents:function(e){e.preventDefault;var t=e.currentTarget.getAttribute("data-action");Dashboard.Global.lastClickedActionBtn=e.currentTarget,Dashboard.Global.lastVisitedURL=e.currentTarget.getAttribute("data-href")||Dashboard.Global.lastVisitedURL,Dashboard.Actions[t].call(Dashboard.Actions,e)},handleViewBtnClick:function(e){e.preventDefault(),Dashboard.Global.lastClickedViewBtn=this,Dashboard.getView(Dashboard.Global.lastClickedViewBtn.getAttribute("data-href"))},handleRefreshClick:function(e){Dashboard.reload()}},Dashboard={Handlers:{},Global:{content:"#content",lastClickedViewBtn:null,activeModal:".modal.active",lastVisitedURL:null,viewBtn:".view-btn",afterView:null},Actions:{create:function(e,t){if("function"==typeof arguments[0])var a=arguments[0],e=null;else a=null;var n=e||document.querySelector(Dashboard.Global.activeModal).getAttribute("data-action-url");Dashboard.actionRequest(n,null,a)},update:function(e,t){Dashboard.bindToMany(!1,e,"input"),$(".done-btn").unbind("click").click(function(a){var n=Dashboard.serializeFormData(),o=$(e.target).parents("li").data("id");for(prop in n)""==n[prop]&&delete n[prop];n.id=o,Dashboard.actionRequest(t,n,!1,"PUT")})},delete:function(e,t){var a=$(e.target).parents("li").find(".name");$("#delete-modal").find("b.text-holder").text(a.text()).end().find(".del").click(function(){Dashboard.actionRequest(t,{id:a.parents("li").data("id")},function(){$("#delete-modal").closeModal()},"DELETE")})}},Events:{bind:function(e,t,a,n){function o(e,t){var a=e.parentNode;return a.matches(t)?a:o(a,t)}document.querySelector(t).addEventListener(e,function(e){var t=e.target;if(match=t.matches(a),match||t.matches(a.trim()+" *")){var r=match?t:o(t,a);n.call(r,e)}})},init:function(){this.bindActionEvents()},bindActionEvents:function(){document.querySelectorAll("[data-action]").forEach(function(e,t){e.addEventListener("click",DashboardHandlers.handleClickEvents,!1)})}},wait:function(e,t){window.setTimeout(function(){e.call()},t)},getView:function(e){Dashboard.Global.lastVisitedURL=e,Dashboard.viewAjax(Dashboard.Global.lastVisitedURL,{},function(e){Dashboard.renderResponse(e)})},sanitizeForm:function(){document.querySelector(".modal.active").querySelectorAll("input[type=text], input[type=email], input[type=telephone]").forEach(function(e){e.value=""})},serializeFormData:function(e,t){var a=e||document.querySelectorAll(".modal.active form"),n=new FormData;return a.forEach(function(e){e.querySelectorAll("input[name], select[name], textarea[name]").forEach(function(e){if("file"==e.getAttribute("type")){var a=e.getAttribute("name");e[0].files.forEach(function(e,t){n.append(a,t)})}else(""!=e.value||t)&&("checkbox"!=e.getAttribute("type")||e.checked)&&n.append(e.getAttribute("name"),e.value)})}),n},init:function(){var e=document.querySelector(".refresh");e&&e.addEventListener("click",DashboardHandlers.handleRefreshClick,!1),document.querySelectorAll(Dashboard.Global.viewBtn).forEach(function(e,t){e.addEventListener("click",DashboardHandlers.handleViewBtnClick,!1)})},bindToMany:function(e,t,a){var n=e||$("#edit-modal"),o=0,r=$(t.target).parents("li").find(".item-props");SelectorObj=Dashboard.serializeFormData(!1,!1,!0),SelectorArray=[];for(name in SelectorObj)SelectorArray.push(name);for(;o<SelectorArray.length;)"input"==a?n.find("[name="+SelectorArray[o]+"]").val(r.find("."+SelectorArray[o]).text()).siblings("label").addClass("active"):n.find(SelectorArray[o]).text(r.find(SelectorArray[o]).text()),o++},viewAjax:function(e,t,a){var n=new XMLHttpRequest;this.viewReadyStateChange=function(e){e.readyState===XMLHttpRequest.DONE&&200===e.status&&a.call({},e.responseText)},n.onreadystatechange=function(){Dashboard.viewReadyStateChange(n)},"function"==typeof this.getView.extend&&this.getView.extend(n),n.open("GET",e+Utility.encodeURL(t));var o=document.querySelector('meta[name="csrf-token"]');o&&n.setRequestHeader("X-CSRF-TOKEN",o.getAttribute("content")),n.send()},actionRequest:function(e,t,a,n){var o=new XMLHttpRequest;o.open(n||"post","GET"==n?e+Utility.encodeURL(t):e),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){var e=200===o.status?JSON.parse(o.responseText):null;e.message&&(Dashboard.notify(e.message,1e3),e.error||(Dashboard.sanitizeForm(),Dashboard.reload())),a&&a.call({},e)}};var r=document.querySelector('meta[name="csrf-token"]');r&&o.setRequestHeader("X-CSRF-TOKEN",r.getAttribute("content")),o.send("GET"==n?null:t||Dashboard.serializeFormData())},renderResponse:function(e){document.querySelector(Dashboard.Global.content).innerHTML=e,Dashboard.Events.bindActionEvents(),"function"==typeof Dashboard.Global.afterView&&Dashboard.Global.afterView()},reload:function(){Dashboard.Global.lastClickedViewBtn.click()},notify:function(e,t,a){var n=document.querySelector(".notification");n.querySelector(".msg").innerText=e,n.classList.add("show"),Dashboard.wait(function(){n.classList.remove("show"),a.call({},e)},t)},options:function(e){for(option in e)Dashboard.Global[option]=e[option]}},Utility={search:function(e,t,a){var n=$(e.target).val();if(this.search.results||(this.search.results={}),null!=this.search.results[n])this.search.results[n].show();else{var o=$(t);o.hide(),o.each(function(){var e=$(t).find(a),o=new RegExp(n,"i");e.text().match(o)?e.parent(t).addClass("SEARCH_MATCH"):e.parent(t).removeClass("SEARCH_MATCH")}),this.search.results[n]=$(".SEARCH_MATCH"),0===this.search.results[n].length?$(".void-content-message").show():(this.search.results[n].show(),$(".void-content-message").hide())}},upperCaseFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},encodeURL:function(e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.length?"?"+t.join("&"):""},showPhoto:function(e,t){var a=new FileReader;if(e.files&&e.files[0]?a.readAsArrayBuffer(e.files[0]):console.log("Files is empty!"),!/image/i.test(e.files[0].type))return console.log("Files is not an image!"),!1;a.onloadend=function(){var e=new Blob([a.result]);window.URL=window.URL||window.webkitURL;var n=window.URL.createObjectURL(e);t.src=n,"function"==typeof Utility.showPhoto.ready&&Utility.showPhoto.ready(e)}}};document.addEventListener("DOMContentLoaded",function(){Dashboard.Events.init(),Dashboard.init()},!1);